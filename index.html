<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Style Code Formatter</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <style>
        /* Custom styles for code formatting */
        .formatted-code {
            font-family: 'Courier New', monospace;
            background-color: #1e1e1e;
            color: #d4d4d4;
            border-radius: 8px;
            padding: 20px;
            position: relative;
            overflow-x: auto;
        }
        
        /* Syntax highlighting colors */
        .comment { color: #6A9955; }       // Green for comments
        .keyword { color: #569CD6; }      // Blue for keywords
        .string { color: #CE9178; }       // Orange for strings
        .number { color: #B5CEA8; }       // Light green for numbers
        .function { color: #DCDCAA; }     // Yellow for functions
        
        /* Toggle switch styling */
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: #4CAF50;
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        /* Animation for the format button */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .animate-pulse {
            animation: pulse 2s infinite;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- Header Section -->
    <audio id="welcomeSound" src="https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.mp3" preload="auto"></audio>
    <header class="bg-gradient-to-r from-indigo-900 to-purple-800 text-white p-6 shadow-lg">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-3xl font-bold tracking-tighter">
                <span class="text-indigo-200 bg-clip-text text-transparent bg-gradient-to-r from-indigo-300 to-purple-300">AI</span> Code Formatter
            </h1>
            <div class="flex items-center space-x-4">
                <span class="text-sm">Dark Mode</span>
                <label class="switch">
                    <input type="checkbox" id="darkModeToggle">
                    <span class="slider"></span>
                </label>
            </div>
        </div>
    </header>

    <!-- Main Content Area -->
    <main class="container mx-auto p-4 md:p-8 transform transition-all duration-300 hover:scale-[0.99]">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 backdrop-blur-sm">
            <!-- Input Section -->
            <div class="bg-white/90 backdrop-blur-sm rounded-xl shadow-xl p-6 border border-white/20 transition-all hover:shadow-2xl">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">
                    Input Your Code
                    <span class="text-sm text-indigo-600 block mt-1">
                        // Paste your unformatted code here for processing
                    </span>
                </h2>
                <textarea 
                    id="inputCode" 
                    class="w-full h-96 p-4 border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
                    placeholder="// Paste your code here...&#10;// The AI formatter will analyze and clean it up"
                ></textarea>
                <div class="flex justify-between mt-4">
                    <div>
                        <label for="language" class="block text-sm font-medium text-gray-700">
                            Language
                            <span class="text-xs text-gray-500">
                                // Select language for syntax-specific formatting
                            </span>
                        </label>
                        <select id="language" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md">
                            <option value="javascript" selected>JavaScript</option>
                            <option value="python">Python</option>
                            <option value="java">Java</option>
                            <option value="csharp">C#</option>
                            <option value="php">PHP</option>
                            <option value="html">HTML</option>
                            <option value="css">CSS</option>
                        </select>
                    </div>
                    <div class="flex items-end">
                        <button 
                            id="formatBtn" 
                            class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-6 rounded-lg transition-colors animate-pulse"
                        >
                            Format Code
                            <span class="block text-xs text-indigo-200 opacity-80">
                                // Applies AI-powered formatting rules
                            </span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Output Section -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">
                    Formatted Code
                    <span class="text-sm text-green-600 block mt-1">
                        // This is your clean, standardized code output
                    </span>
                </h2>
                <div id="outputCode" class="formatted-code h-96 overflow-auto">
                    <p class="text-gray-400 italic">
                        // Your formatted code will appear here<br>
                        // Each modification is clearly commented<br>
                        // AI suggests improvements in green
                    </p>
                </div>
                <div class="flex justify-end mt-4 space-x-3">
                    <button 
                        id="copyBtn" 
                        class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-lg transition-colors"
                    >
                        Copy Code
                    </button>
                    <button 
                        id="downloadBtn" 
                        class="bg-indigo-100 hover:bg-indigo-200 text-indigo-800 font-bold py-2 px-4 rounded-lg transition-colors"
                    >
                        Download
                    </button>
                </div>
            </div>
        </div>

        <!-- Features Section -->
        <div class="mt-12 bg-white rounded-lg shadow-lg p-6">
            <h2 class="text-2xl font-semibold text-gray-800 mb-6">
                AI-Powered Formatting Features
                <span class="text-sm text-indigo-600 block mt-1">
                    // Our formatter provides these intelligent processing capabilities
                </span>
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-gray-50 p-4 rounded-lg">
                    <div class="flex items-center mb-2">
                        <div class="bg-indigo-100 p-2 rounded-full mr-3">
                            <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/5c9efaf7-8240-4633-b62a-f668b34f50fc.png" alt="Icon of structured code blocks with aligned indentations" class="w-8 h-8" />
                        </div>
                        <h3 class="font-medium text-gray-900">Structure Analysis</h3>
                    </div>
                    <p class="text-sm text-gray-600">
                        // Intelligently reorganizes nested blocks<br>
                        // Standardizes indentation patterns<br>
                        // Aligns related code segments
                    </p>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg">
                    <div class="flex items-center mb-2">
                        <div class="bg-indigo-100 p-2 rounded-full mr-3">
                            <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/7f9c5314-ffa0-4d55-b0c7-78a5b06c5d81.png" alt="Icon of colored syntax highlights for better readability" class="w-8 h-8" />
                        </div>
                        <h3 class="font-medium text-gray-900">Syntax Highlighting</h3>
                    </div>
                    <p class="text-sm text-gray-600">
                        // Language-aware tokenization<br>
                        // Color-coded syntax elements<br>
                        // Consistent style across codebase
                    </p>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg">
                    <div class="flex items-center mb-2">
                        <div class="bg-indigo-100 p-2 rounded-full mr-3">
                            <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/504282c6-8c94-404a-9a2a-6ddbd2e5dccd.png" alt="Icon of a checklist for code quality validation" class="w-8 h-8" />
                        </div>
                        <h3 class="font-medium text-gray-900">Quality Checks</h3>
                    </div>
                    <p class="text-sm text-gray-600">
                        // Detects potential issues<br>
                        // Suggests improvements<br>
                        // Documents changes with comments
                    </p>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-gray-300 py-6 mt-12">
        <div class="container mx-auto px-4 text-center">
            <p>
                AI Code Formatter - Intelligent Code Standardization Tool
                <span class="block text-xs text-gray-500 mt-1">
                    // This tool helps maintain consistent coding standards across your team
                </span>
            </p>
        </div>
    </footer>

    <script>
        // Main formatter function - processes the input code with AI-style formatting
        function formatCode(code, language) {
            // Basic formatting steps (would be enhanced with real AI processing)
            let formattedCode = code;
            
            // 1. Standardize line endings
            formattedCode = formattedCode.replace(/\r\n/g, '\n');
            
            // 2. Remove trailing whitespace
            formattedCode = formattedCode.replace(/[ \t]+$/gm, '');
            
            // 3. Add consistent indentation
            if (language === 'python') {
                formattedCode = applyPythonIndentation(formattedCode);
            } else {
                // Default indentation for most languages
                formattedCode = applyStandardIndentation(formattedCode);
            }
            
            // 4. Add explanatory comments for complex blocks
            formattedCode = addExplanatoryComments(formattedCode, language);
            
            // 5. Color coding - we'll do this in the display, not the stored text
            return formattedCode;
        }

        // Applies standard indentation (4 spaces)
        function applyStandardIndentation(code) {
            // Count opening/closing braces to determine indentation level
            let lines = code.split('\n');
            let indentLevel = 0;
            let inBlockComment = false;
            
            return lines.map(line => {
                // Skip empty lines
                if (line.trim() === '') return line;
                
                // Handle block comments
                if (line.includes('/*') && !line.includes('*/')) {
                    inBlockComment = true;
                }
                
                // Decrease indent for closing brace if not in block comment
                if (!inBlockComment && (line.includes('}') || line.includes(')'))) {
                    indentLevel = Math.max(0, indentLevel - 1);
                }
                
                // Apply current indentation
                let indentedLine = '    '.repeat(indentLevel) + line.trim();
                
                // Increase indent for opening brace if not in block comment
                if (!inBlockComment && (line.includes('{') || line.includes('('))) {
                    indentLevel += 1;
                }
                
                // Check for end of block comment
                if (inBlockComment && line.includes('*/')) {
                    inBlockComment = false;
                }
                
                return indentedLine;
            }).join('\n');
        }

        // Special handling for Python indentation
        function applyPythonIndentation(code) {
            let lines = code.split('\n');
            let indentLevel = 0;
            
            return lines.map(line => {
                // Skip empty lines
                if (line.trim() === '') return line;
                
                // Check for dedent patterns
                if (line.trim().startsWith('return') || 
                    line.trim().startsWith('pass') || 
                    line.trim().startsWith('break') ||
                    line.trim().startsWith('continue') ||
                    line.trim().startsWith('raise')) {
                    indentLevel = Math.max(0, indentLevel - 1);
                }
                
                // Apply current indentation
                let indentedLine = '    '.repeat(indentLevel) + line.trim();
                
                // Check for indent patterns
                if (line.trim().endsWith(':')) {
                    indentLevel += 1;
                }
                
                return indentedLine;
            }).join('\n');
        }

        // Adds explanatory comments for complex code blocks
        function addExplanatoryComments(code, language) {
            let lines = code.split('\n');
            let complexBlockStart = -1;
            let complexKeywords = ['for', 'while', 'if', 'switch', 'try', 'def', 'function'];
            
            // Find areas that might need explanation
            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();
                
                // Look for complex blocks
                if (complexKeywords.some(keyword => line.startsWith(keyword + ' ') || 
                                              line.startsWith(keyword + '('))) {
                    complexBlockStart = i;
                }
                
                // If we've found a complex block and reached its end (empty line or dedent)
                if (complexBlockStart !== -1 && 
                    (line === '' || 
                     (i > 0 && lines[i].trim().length > 0 && 
                      lines[i].search(/\S/) <= lines[complexBlockStart].search(/\S/)))) {
                      
                    // Insert explanation before the block
                    const explanation = `\n// ${getExplanation(lines[complexBlockStart], language)}\n`;
                    lines.splice(complexBlockStart, 0, explanation);
                    i += 1; // Skip the inserted line
                    complexBlockStart = -1;
                }
            }
            
            return lines.join('\n');
        }

        // Generates simple explanations for code structures
        function getExplanation(line, language) {
            line = line.trim();
            
            // Function declarations
            if (line.startsWith('function ') || 
                (language === 'python' && line.startsWith('def ')) ||
                (['java', 'csharp'].includes(language) && line.contains('(') && line.contains(')') && 
                 (line.contains(' void ') || line.contains(' int ') || line.contains(' String ')))) {
                return 'Function declaration - performs a specific task with optional parameters and return value';
            }
            
            // Loops
            if (line.startsWith('for ') || line.startsWith('while ')) {
                return 'Loop construct - repeatedly executes the following block while condition is true';
            }
            
            // Conditionals
            if (line.startsWith('if ')) {
                return 'Conditional statement - executes the following block only if the condition evaluates to true';
            }
            
            // Default explanation
            return 'Code block - executed sequentially as part of the normal program flow';
        }

        // Applies syntax highlighting to the output
        function applySyntaxHighlighting(code, language) {
            // This would be replaced with a proper syntax highlighter in production
            const highlightedCode = code
                .replace(/\/\/.*$/gm, match => `<span class="comment">${match}</span>`)  // Single line comments
                .replace(/\/\*[\s\S]*?\*\//g, match => `<span class="comment">${match}</span>`)  // Block comments
                .replace(/"([^"]*)"|'([^']*)'/g, match => `<span class="string">${match}</span>`)  // Strings
                .replace(/\b(function|if|else|for|while|return|class|import|export|try|catch|finally)\b/g, 
                         match => `<span class="keyword">${match}</span>`)  // Keywords
                .replace(/\b(\d+)\b/g, match => `<span class="number">${match}</span>`);  // Numbers
                
            return highlightedCode;
        }

        // DOM event listeners
        document.addEventListener('DOMContentLoaded', function() {
            const formatBtn = document.getElementById('formatBtn');
            const copyBtn = document.getElementById('copyBtn');
            const downloadBtn = document.getElementById('downloadBtn');
            const darkModeToggle = document.getElementById('darkModeToggle');
            const inputCode = document.getElementById('inputCode');
            const outputCode = document.getElementById('outputCode');
            const languageSelect = document.getElementById('language');

            // Format button click handler
            formatBtn.addEventListener('click', function() {
                const code = inputCode.value;
                const language = languageSelect.value;
                
                if (code.trim() === '') {
                    outputCode.innerHTML = '<p class="text-red-400 italic">// Please enter some code to format</p>';
                    return;
                }
                
                const formatted = formatCode(code, language);
                const highlighted = applySyntaxHighlighting(formatted, language);
                outputCode.innerHTML = highlighted;
            });

            // Copy button click handler
            copyBtn.addEventListener('click', function() {
                const textToCopy = outputCode.textContent;
                if (textToCopy.trim() === '') {
                    alert('No formatted code to copy!');
                    return;
                }
                
                navigator.clipboard.writeText(textToCopy)
                    .then(() => {
                        // Visual feedback
                        const originalText = copyBtn.textContent;
                        copyBtn.textContent = 'Copied!';
                        copyBtn.classList.remove('bg-gray-200');
                        copyBtn.classList.add('bg-green-500', 'text-white');
                        
                        setTimeout(() => {
                            copyBtn.textContent = originalText;
                            copyBtn.classList.remove('bg-green-500', 'text-white');
                            copyBtn.classList.add('bg-gray-200');
                        }, 2000);
                    })
                    .catch(err => {
                        console.error('Failed to copy: ', err);
                        alert('Failed to copy code to clipboard');
                    });
            });

            // Download button click handler
            downloadBtn.addEventListener('click', function() {
                const textToDownload = outputCode.textContent;
                if (textToDownload.trim() === '') {
                    alert('No formatted code to download!');
                    return;
                }
                
                const language = languageSelect.value;
                const extension = getFileExtension(language);
                const filename = `formatted_code.${extension}`;
                
                const blob = new Blob([textToDownload], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            });

            // Dark mode toggle
            darkModeToggle.addEventListener('change', function() {
                document.body.classList.toggle('dark');
            });

            // Play welcome sound on page load
        document.addEventListener('DOMContentLoaded', function() {
            const welcomeSound = document.getElementById('welcomeSound');
            welcomeSound.volume = 0.3;
            welcomeSound.play().catch(e => console.log("Audio play prevented:", e));
            
            // Add subtle animation to header
            const header = document.querySelector('header');
            header.classList.add('animate__animated', 'animate__fadeInDown');
        });

        // Helper function to get file extension by language
            function getFileExtension(lang) {
                const extensions = {
                    'javascript': 'js',
                    'python': 'py',
                    'java': 'java',
                    'csharp': 'cs',
                    'php': 'php',
                    'html': 'html',
                    'css': 'css'
                };
                return extensions[lang] || 'txt';
            }
        });
    </script>
</body>
</html>
